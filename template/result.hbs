(function ()
{
    var {{name}} = {};

    typeof module !== 'undefined' && module.exports ? module.exports = {{name}}
                                                    : window.{{name}} = {{name}};

    function _define(name, requires, method)
    {
        {{name}}[name] = {
            requires: requires,
            body    : method
        };

        delete requireMarks[name];
    }

    function _init(methods)
    {
        for (var i = 0, len = methods.length; i < len; i++) _require(methods[i]);
    }

    var requireMarks = {};

    function _require(name)
    {
        if (requireMarks.hasOwnProperty(name)) return {{name}}[name];

        var requires = {{name}}[name].requires,
            body     = {{name}}[name].body;

        for (var i = 0, len = requires.length; i < len; i++)
        {
            requires[i] = _require(requires[i]);
        }

        requires.push({{name}});

        {{name}}[name] = body.apply({{name}}, requires);

        requireMarks[name] = true;

        return {{name}}[name];
    }

    {{code}}

    _init([
        {{methodList}}
    ]);
})();