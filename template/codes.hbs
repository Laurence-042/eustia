var _ = {};

function _define(name, requires, method)
{
    _[name] = {
        requires: requires,
        body    : method
    };

    delete requireMarks[name];
}

function _init(methods)
{
    for (var i = 0, len = methods.length; i < len; i++) _require(methods[i]);
}

var requireMarks = {};

function _require(name)
{
    if (requireMarks.hasOwnProperty(name)) return _[name];

    var requires = _[name].requires,
        body     = _[name].body,
        len      = requires.length;

    for (var i = 0; i < len; i++) requires[i] = _require(requires[i]);

    requires.push(_);

    var exports = body.apply(_, requires);
    if (exports) _[name] = exports;

    requireMarks[name] = true;

    return _[name];
}

{{code}}

_init([
    {{methodList}}
]);

return _;